{"version":3,"sources":["../src/aplus_highlightcode.js"],"names":["$","fn","highlightCode","each","codeBlock","clone","wrapper","append","replaceWith","hljs","highlightElement","pre","lines","html","split","list","addClass","i","length"],"mappings":"4FAcA,OACA,O,mDAQAA,UAAEC,EAAF,CAAKC,aAAL,CAAqB,UAAkB,CAErC,MAAO,MAAKC,IAAL,CAAU,UAAW,IACtBC,CAAAA,CAAS,CAAG,cAAE,IAAF,EAAQC,KAAR,EADU,CAEtBC,CAAO,CAAG,cAAE,aAAF,CAFY,CAG1BA,CAAO,CAACC,MAAR,CAAeH,CAAf,EACA,cAAE,IAAF,EAAQI,WAAR,CAAoBF,CAApB,EAkCAG,UAAKC,gBAAL,CAAsBN,CAAS,CAAC,CAAD,CAA/B,EAMA,OAHIO,CAAAA,CAAG,CAAG,cAAEP,CAAF,CAGV,CAFIQ,CAAK,CAAGD,CAAG,CAACE,IAAJ,GAAWC,KAAX,CAAiB,aAAjB,CAEZ,CADIC,CAAI,CAAG,cAAE,UAAF,EAAcC,QAAd,CAAuB,KAAvB,CACX,CAASC,CAAC,CAAG,CAAb,CAAgBA,CAAC,EAAIL,CAAK,CAACM,MAA3B,CAAmCD,CAAC,EAApC,CAAwC,CACpCF,CAAI,CAACR,MAAL,CAAY,sCAAsCU,CAAtC,CAA0C,yBAA1C,CAAoEL,CAAK,CAACK,CAAC,CAAG,CAAL,CAAzE,CAAmF,YAA/F,CACH,CACDN,CAAG,CAACE,IAAJ,CAASE,CAAT,CACD,CAhDM,CAiDR,C","sourcesContent":["/**\n * A+ helper function for elements that show source code with syntax highlighting.\n * Syntax highlighting uses the highlight.js library.\n * This function adds line numbers\n * (and a copy-to-clipboard button (copying disabled since it requires clipboard.js)).\n * \n * Usage:\n * $(element).highlightCode();\n * \n * Source: A+ (a-plus/assets/js/aplus.js)\n * License: GNU GPL v3\n * \n * @module mod_astra/aplus_highlightcode\n */\nimport $ from 'jquery';\nimport hljs from './highlight';\n\n/**\n * Highlights code element.\n */\n\n//var copyTargetCounter = 0;\n\n$.fn.highlightCode = function(options) {\n\n  return this.each(function() {\n    var codeBlock = $(this).clone();\n    var wrapper = $('<div></div>');\n    wrapper.append(codeBlock);\n    $(this).replaceWith(wrapper);\n\n    // Use $(element).highlightCode{noCopy: true} to prevent copy button\n    /* // disabled due to dependency on clipboard.js\n    if (!options || !options.noCopy) {\n      var buttonContainer = $('<p></p>').prependTo(wrapper);\n      var copyButtonContent = $('<span class=\"glyphicon glyphicon-copy\" aria-hidden=\"true\"></span>');\n      var copyButtonText = $('<span></span>').text('Copy to clipboard');\n      var copyButton = $('<button data-clipboard-target=\"#clipboard-content-' + copyTargetCounter + '\" class=\"btn btn-xs btn-primary\" id=\"copy-button-' + copyTargetCounter + '\"></button>');\n      copyButtonContent.appendTo(copyButton);\n      copyButtonText.appendTo(copyButton);\n      copyButton.appendTo(buttonContainer);\n\n      var hiddenTextarea = $('<textarea id=\"clipboard-content-' + copyTargetCounter + '\" style=\"display: none; width: 1px; height: 1px;\"></textarea>').text(codeBlock.text());\n      hiddenTextarea.appendTo(buttonContainer);\n\n      // clipboard.js cannot copy from invisible elements\n      copyButton.click(function() {\n        hiddenTextarea.show();\n      });\n\n      var clipboard = new Clipboard('#copy-button-' + copyTargetCounter);\n      clipboard.on(\"error\", function(e) {\n          hiddenTextarea.hide();\n      });\n      clipboard.on(\"success\", function(e) {\n          hiddenTextarea.hide();\n      });\n\n      copyTargetCounter += 1;\n\n    }\n    */\n\n    hljs.highlightElement(codeBlock[0]);\n\n    // Add line numbers.\n    var pre = $(codeBlock);\n    var lines = pre.html().split(/\\r\\n|\\r|\\n/g);\n    var list = $(\"<table/>\").addClass(\"src\");\n    for (var i = 1; i <= lines.length; i++) {\n        list.append('<tr><td class=\"num unselectable\">' + i + '</td><td class=\"src\">' + lines[i - 1] + '</td></tr>');\n    }\n    pre.html(list);\n  });\n};\n\n"],"file":"aplus_highlightcode.min.js"}