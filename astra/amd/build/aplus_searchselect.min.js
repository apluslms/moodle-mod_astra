define ("mod_astra/aplus_searchselect",["jquery"],function(a){"use strict";a=function(a){return a&&a.__esModule?a:{default:a}}(a);(function(a){var b={widget_selector:"#search-select-widget",field_selector:"input[type=\"text\"]",search_selector:".dropdown-toggle",result_selector:".search-options",selection_selector:".search-selected"};function c(c,d){this.element=a(c);this.timeout=null;if("SELECT"==this.element.prop("tagName")&&this.element.prop("multiple")){this.settings=a.extend({},b,d);this.init()}}a.extend(c.prototype,{init:function init(){this.widget=a(this.settings.widget_selector).clone().removeAttr("id").removeClass("hide").insertBefore(this.element);this.element.hide();var b=this;this.selection=this.widget.find(this.settings.selection_selector);this.selection_li=this.selection.find("li").remove();this.element.find("option:selected").each(function(){b.add_selection(a(this).attr("value"),a(this).text())});this.result=this.widget.find(this.settings.result_selector);this.field=this.widget.find(this.settings.field_selector).on("keypress",function(a){if(13==a.keyCode){a.preventDefault();b.search_options(!0)}}).on("keyup",function(a){if(13!=a.keyCode){clearTimeout(b.timeout);b.timeout=setTimeout(function(){b.search_options(!0);b.field.focus()},500)}});this.search=this.widget.find(this.settings.search_selector).on("show.bs.dropdown",function(){b.search_options()});this.element.parents("form").on("submit",function(){b.finish()})},search_options:function search_options(b){if(b&&!1===this.result.is(":visible")){this.search.find("button").dropdown("toggle");return}this.result.find("li:not(.not-found)").remove();this.result.find("li.not-found").hide();var c="option",d=this.field.val().trim();if(0<d.length){c+=":contains("+this.field.val()+")"}var e=this.element.find(c);if(0===e.size()){this.result.find("li.not-found").show()}else{var f=this;e.slice(0,20).each(function(){var b=a("<li><a data-value=\""+a(this).attr("value")+"\">"+a(this).text()+"</a></li>");b.find("a").on("click",function(){f.add_selection(a(this).attr("data-value"),a(this).text())});f.result.append(b)})}},add_selection:function add_selection(b,c){if(0===this.selection.find("[data-value=\""+b+"\"]").size()){var d=this.selection_li.clone(),e=this;d.find(".name").text(c);d.find("button").attr("data-value",b).on("click",function(){a(this).parent("li").remove()});this.selection.append(d)}},finish:function finish(){this.widget.remove();var b=this.element.show();b.find("option:selected").prop("selected",!1);this.selection.find("button").each(function(){b.find("option[value=\""+a(this).attr("data-value")+"\"]").prop("selected",!0)})}});a.fn.aplusSearchSelect=function(b){return this.each(function(){if(!a.data(this,"plugin_aplusSearchSelect")){a.data(this,"plugin_aplusSearchSelect",new c(this,b))}})}})(a.default,window,document)});
//# sourceMappingURL=aplus_searchselect.min.js.map
